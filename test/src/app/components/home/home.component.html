<div class="container">
  <div class="home-container">
    <h1>Skin Marketplace</h1>
    
    <div *ngIf="loading" class="loading">Loading...</div>
    
    <div *ngIf="error" class="error-message">
      <p>Error loading skins. Please try again later.</p>
    </div>

    <!-- Filter input field -->
    <div class="filter-bar">
      <input 
        type="text" 
        placeholder="Filtrar por nome ou descrição" 
        [(ngModel)]="filterText" 
        (input)="onFilterChange(filterText)"
        class="filter-input"
      />
    </div>

    <!-- Skins grid -->
    <div class="skins-grid" *ngIf="!loading && !error">
      <div class="skin-card" *ngFor="let skin of filteredSkins">
        <div class="skin-card-inner">
          <!-- Skin image -->
          <img [src]="skin.imagem" [alt]="skin.nome" class="skin-image">
          
          <!-- Owner info -->
          <div class="owner-info">
            <img 
              [src]="ownerPhotos[skin.ownerId] || 'assets/default-avatar.png'" 
              [alt]="'Foto de ' + (ownerNames[skin.ownerId] || 'Usuário')" 
              class="owner-avatar"
              (error)="ownerPhotos[skin.ownerId] = 'assets/default-avatar.png'"
            >
            <span class="owner-name">{{ ownerNames[skin.ownerId] || 'Usuário' }}</span>
          </div>
          
          <!-- Wishlist button -->
          <button 
            class="wishlist-button new-wishlist-btn" 
            [class.wishlist-active]="isInWishlist(skin.id)" 
            (click)="toggleWishlist(skin.id)"
            *ngIf="!currentUser || skin.ownerId !== currentUser.id">
            ♥
          </button>
          
          <!-- Skin details -->
          <div class="skin-info">
            <h3>{{ skin.nome }}</h3>
            <div class="float-bar-container">
              <div class="float-bar-bg">
                <div class="float-bar-indicator" [style.left]="(skin.float * 100) + '%'">
                  <span class="float-indicator-value"></span>
                </div>
              </div>
              <div class="float-bar-labels">
                <span>0.00</span>
                <span>0.07</span>
                <span>0.15</span>
                <span>0.38</span>
                <span>0.45</span>
                <span>1.00</span>
              </div>
            </div>
            <p class="float">Float: {{ skin.float | number:'1.2-3' }}</p>
            <p class="price">${{ skin.preco | number:'1.2-2' }}</p>
            <button 
              class="buy-button" 
              (click)="buySkin(skin)" 
              [disabled]="!skin.venda || (currentUser && skin.ownerId === currentUser.id)">
              {{ (currentUser && skin.ownerId === currentUser.id) ? 'Sua skin' : 'Comprar' }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>